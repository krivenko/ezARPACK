/*
 *  /MathJax/extensions/a11y/auto-collapse.js
 *
 *  Copyright (c) 2009-2018 The MathJax Consortium
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

!function(f){var d=f.config.menuSettings,e={},b=MathJax.Ajax.config.path;b.a11y||(b.a11y=f.config.root+"/extensions/a11y");var a=MathJax.Extension["auto-collapse"]={version:"1.6.0",config:f.CombineConfig("auto-collapse",{disabled:!1}),dependents:[],Enable:function(c,g){d.autocollapse=!0,g&&(e.autocollapse=!0),this.config.disabled=!1,MathJax.Extension.collapsible.Enable(!1,g),c&&f.Queue(["Reprocess",f],["CollapseWideMath",this])},Disable:function(c,g){d.autocollapse=!1,g&&(e.autocollapse=!1),this.config.disabled=!0;for(var i=this.dependents.length-1;0<=i;i--){var h=this.dependents[i];h.Disable&&h.Disable(!1,g)}c&&f.Queue(["Rerender",f])},Dependent:function(c){this.dependents.push(c)},Startup:function(){var c=MathJax.Extension.collapsible;c&&c.Dependent(this),f.postInputHooks.Add(["Filter",a],150),f.Queue(function(){return a.CollapseWideMath()}),window.addEventListener?window.addEventListener("resize",a.resizeHandler,!1):window.attachEvent?window.attachEvent("onresize",a.resizeHandler):window.onresize=a.resizeHandler},Filter:function(c,g,h){c.enriched&&!this.config.disabled&&("block"===c.root.Get("display")||h.parentNode.childNodes.length<=3)&&(c.root.SRE={action:this.Actions(c.root)})},Actions:function(c){var g=[];return this.getActions(c,0,g),this.sortActions(g)},getActions:function(h,j,l){if(!h.isToken&&h.data){j++;for(var k,g=0,c=h.data.length;g<c;g++){h.data[g]&&((k=h.data[g]).collapsible?(l[j]||(l[j]=[]),l[j].push(k),this.getActions(k.data[1],j,l)):this.getActions(k,j,l))}}},sortActions:function(c){for(var g=[],i=0,h=c.length;i<h;i++){c[i]&&(g=g.concat(c[i].sort(this.sortActionsBy)))}return g},sortActionsBy:function(c,g){return(c=c.data[1].complexity)<(g=g.data[1].complexity)?-1:g<c?1:0},CollapseWideMath:function(c){if(!this.config.disabled){this.GetContainerWidths(c);var g=f.getAllJax(c),h={collapse:[],jax:g,m:g.length,i:0,changed:!1};return this.collapseState(h)}},collapseState:function(g){for(var h=g.collapse;g.i<g.m;){var k=g.jax[g.i],j=k.root.SRE;if(g.changed=!1,j&&j.action.length&&(j.cwidth<j.m||j.cwidth>j.M)){var c=this.getActionWidths(k,g);if(c){return c}this.collapseActions(j,g),g.changed&&h.push(k.SourceElement())}g.i++}if(0!==h.length){return 1===h.length&&(h=h[0]),f.Rerender(h)}},collapseActions:function(h,l){for(var p=h.width,m=p,g=1000000,c=h.action.length-1;0<=c;c--){var j=h.action[c],k=j.selection;p>h.cwidth?(j.selection=1,m=j.SREwidth,g=p):j.selection=2,p=j.SREwidth,h.DOMupdate?document.getElementById(j.id).setAttribute("selection",j.selection):j.selection!==k&&(l.changed=!0)}h.m=m,h.M=g},getActionWidths:function(c,g){if(!c.root.SRE.actionWidths){MathJax.OutputJax[c.outputJax].getMetrics(c);try{this.computeActionWidths(c)}catch(c){if(!c.restart){throw c}return MathJax.Callback.After(["collapseState",this,g],c.restart)}g.changed=!0}return null},computeActionWidths:function(h){var j,l=h.root.SRE,k=l.action,g={};for(l.width=h.sreGetRootWidth(g),j=k.length-1;0<=j;j--){k[j].selection=2}for(j=k.length-1;0<=j;j--){var c=k[j];null==c.SREwidth&&(c.selection=1,c.SREwidth=h.sreGetActionWidth(g,c))}l.actionWidths=!0},GetContainerWidths:function(q){for(var m,h,g,k=f.getAllJax(q),p=MathJax.HTML.Element("span",{style:{display:"block"}}),u=[],c=0,j=k.length;c<j;c++){g=(h=k[c]).root,SRE=g.SRE,SRE&&SRE.action.length&&(null==SRE.width&&(h.sreGetMetrics(),SRE.m=SRE.width,SRE.M=1000000),(m=h.SourceElement()).previousSibling.style.display="none",m.parentNode.insertBefore(p.cloneNode(!1),m),u.push([h,m]))}for(c=0,j=u.length;c<j;c++){h=u[c][0],(m=u[c][1]).previousSibling.offsetWidth&&(h.root.SRE.cwidth=m.previousSibling.offsetWidth*h.root.SRE.em)}for(c=0,j=u.length;c<j;c++){h=u[c][0],(m=u[c][1]).parentNode.removeChild(m.previousSibling),m.previousSibling.style.display=""}},timer:null,running:!1,retry:!1,saved_delay:0,resizeHandler:function(c){a.config.disabled||(a.running?a.retry=!0:(a.timer&&clearTimeout(a.timer),a.timer=setTimeout(a.resizeAction,100)))},resizeAction:function(){a.timer=null,a.running=!0,f.Queue(function(){a.saved_delay=f.processSectionDelay,f.processSectionDelay=0},["CollapseWideMath",a],["resizeCheck",a])},resizeCheck:function(){a.running=!1,f.processSectionDelay=a.saved_delay,a.retry&&(a.retry=!1,setTimeout(a.resizeHandler,0))}};f.Register.StartupHook("End Extensions",function(){null==d.autocollapse?d.autocollapse=!a.config.disabled:a.config.disabled=!d.autocollapse,f.Register.StartupHook("MathMenu Ready",function(){e=MathJax.Menu.cookie;var h,j=MathJax.Menu.ITEM,l=MathJax.Menu.menu,k=j.CHECKBOX(["AutoCollapse","Auto Collapse"],"autocollapse",{action:function(i){a[d.autocollapse?"Enable":"Disable"](!0,!0),MathJax.Menu.saveCookie()}}),g=(l.FindId("Accessibility")||{}).submenu;g?null!==(h=g.IndexOfId("AutoCollapse"))?g.items[h]=k:(h=g.IndexOfId("CollapsibleMath"),g.items.splice(h+1,0,k)):(h=l.IndexOfId("CollapsibleMath"),l.items.splice(h+1,0,k));function c(){a[d.autocollapse?"Enable":"Disable"]()}MathJax.Extension.collapse?c():MathJax.Hub.Register.StartupHook("Auto Collapse Ready",c)},25)},25)}(MathJax.Hub),MathJax.ElementJax.Augment({sreGetMetrics:function(){MathJax.OutputJax[this.outputJax].sreGetMetrics(this,this.root.SRE)},sreGetRootWidth:function(a){return MathJax.OutputJax[this.outputJax].sreGetRootWidth(this,a)},sreGetActionWidth:function(a,b){return MathJax.OutputJax[this.outputJax].sreGetActionWidth(this,a,b)}}),MathJax.OutputJax.Augment({getMetrics:function(){},sreGetMetrics:function(a,b){b.cwidth=1000000,b.width=0,b.em=12},sreGetRootWidth:function(a,b){return 0},sreGetActionWidth:function(a,b,c){return 0}}),MathJax.Hub.Register.StartupHook("HTML-CSS Jax Ready",function(){MathJax.OutputJax["HTML-CSS"].Augment({sreGetMetrics:function(a,b){b.width=a.root.data[0].HTMLspanElement().parentNode.bbox.w,b.em=1/a.HTMLCSS.em/a.HTMLCSS.scale},sreGetRootWidth:function(a,b){var c=a.root.data[0].HTMLspanElement();return b.box=c.parentNode,b.box.bbox.w},sreGetActionWidth:function(a,b,c){return a.root.data[0].toHTML(b.box).bbox.w}})}),MathJax.Hub.Register.StartupHook("SVG Jax Ready",function(){MathJax.OutputJax.SVG.Augment({getMetrics:function(a){this.em=MathJax.ElementJax.mml.mbase.prototype.em=a.SVG.em,this.ex=a.SVG.ex,this.linebreakWidth=a.SVG.lineWidth,this.cwidth=a.SVG.cwidth},sreGetMetrics:function(a,b){b.width=a.root.SVGdata.w/1000,b.em=1/a.SVG.em},sreGetRootWidth:function(a,b){return b.span=document.getElementById(a.inputID+"-Frame"),a.root.SVGdata.w/1000},sreGetActionWidth:function(a,b,d){this.mathDiv=b.span,b.span.appendChild(this.textSVG);try{a.root.data[0].toSVG()}catch(a){var c=a}if(b.span.removeChild(this.textSVG),c){throw c}return a.root.data[0].SVGdata.w/1000}})}),MathJax.Hub.Register.StartupHook("CommonHTML Jax Ready",function(){MathJax.OutputJax.CommonHTML.Augment({sreGetMetrics:function(a,b){b.width=a.root.CHTML.w,b.em=1/a.CHTML.em/a.CHTML.scale},sreGetRootWidth:function(a,b){return b.span=document.getElementById(a.inputID+"-Frame").firstChild,b.tmp=document.createElement("span"),b.tmp.className=b.span.className,a.root.CHTML.w/a.CHTML.scale},sreGetActionWidth:function(a,b,d){b.span.parentNode.replaceChild(b.tmp,b.span),MathJax.OutputJax.CommonHTML.CHTMLnode=b.tmp;try{a.root.data[0].toCommonHTML(b.tmp)}catch(a){var c=a}if(b.tmp.parentNode.replaceChild(b.span,b.tmp),c){throw c}return a.root.data[0].CHTML.w/a.CHTML.scale}})}),MathJax.Hub.Register.StartupHook("NativeMML Jax Ready",function(){MathJax.OutputJax.NativeMML.Augment({sreGetMetrics:function(a,b){var c=document.getElementById(a.inputID+"-Frame");b.width=c.offsetWidth,b.em=1,b.DOMupdate=!0},sreGetRootWidth:function(a,b){return b.span=document.getElementById(a.inputID+"-Frame").firstChild,b.span.offsetWidth},sreGetActionWidth:function(a,b,c){return document.getElementById(c.id).setAttribute("selection",1),b.span.offsetWidth}})}),MathJax.Ajax.Require("[a11y]/collapsible.js"),MathJax.Hub.Register.StartupHook("Collapsible Ready",function(){MathJax.Extension["auto-collapse"].Startup(),MathJax.Hub.Startup.signal.Post("Auto Collapse Ready"),MathJax.Ajax.loadComplete("[a11y]/auto-collapse.js")});
